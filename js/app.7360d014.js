(function(){"use strict";var t={2715:function(t,e,n){var o=n(9242),s=n(3396);function i(t,e){const n=(0,s.up)("router-view");return(0,s.wg)(),(0,s.j4)(n)}var a=n(89);const r={},d=(0,a.Z)(r,[["render",i]]);var l=d,u=n(2483),c=n(7139);const h={class:"main-wrapper"},T={class:"question-page"},I=["onClick"],_={class:"text-question-wrapper"},p={class:"text-question-wrapper"},v=(0,s._)("hr",{style:{width:"700px"}},null,-1),E={class:"branch-list"},f={class:"column-id"},m=(0,s._)("div",null,"Текст ответа",-1),w=["onUpdate:modelValue"],g=["onClick"],A=["onClick"],x=["onClick"],b=(0,s._)("hr",{style:{width:"700px"}},null,-1);function D(t,e,n,i,a,r){const d=(0,s.up)("QuestionstModal");return(0,s.wg)(),(0,s.iD)("div",h,[(0,s._)("div",T,[(0,s._)("h2",null,"Вопрос id: "+(0,c.zw)(a.questionId),1),(0,s._)("div",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.parentList,(t=>((0,s.wg)(),(0,s.iD)("button",{key:t.id,onClick:e=>r.moveToParentId(t.id)}," Перейти к родителю "+(0,c.zw)(t.id),9,I)))),128))]),(0,s._)("div",_,[(0,s.Uk)(" Текст: "),(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":e[0]||(e[0]=t=>a.infoText=t),class:"text-info-question"},"\r\n        ",512),[[o.nr,a.infoText,void 0,{lazy:!0}]])]),(0,s.wy)((0,s._)("div",p,[(0,s.Uk)(" Вопрос: "),(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":e[1]||(e[1]=t=>a.questionText=t),class:"text-info-question"},"          \r\n        ",512),[[o.nr,a.questionText,void 0,{lazy:!0}]])],512),[[o.F8,!1]]),v,(0,s._)("div",null,[(0,s._)("button",{onClick:e[2]||(e[2]=(...t)=>r.ADD_QUESTION&&r.ADD_QUESTION(...t))}," Добавить новый узел "),(0,s._)("button",{onClick:e[3]||(e[3]=(...t)=>r.selectQuestion&&r.selectQuestion(...t))}," Выбрать узел ")]),(0,s._)("div",E,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.answerTransitions,((t,e)=>((0,s.wg)(),(0,s.iD)("div",{key:e,class:"branch-item"},[(0,s._)("div",f," id: "+(0,c.zw)(t.transitionId),1),(0,s._)("div",null,[m,(0,s.wy)((0,s._)("textarea",{"onUpdate:modelValue":e=>t.answerText=e,class:"answer-text"},null,8,w),[[o.nr,t.answerText]])]),(0,s._)("button",{onClick:e=>r.moveToId(t.transitionId)},"Перейти",8,g),(0,s._)("button",{onClick:e=>r.CHECK_AND_DELETE(t.transitionId)},"Удалить узел",8,A),(0,s._)("button",{onClick:e=>r.DELETE_BRANCH(t.transitionId)},"Удалить ветку",8,x)])))),128))]),b,(0,s._)("button",{onClick:e[4]||(e[4]=(...t)=>r.saveData&&r.saveData(...t)),class:"button-save"},"Сохранить")]),a.showQuestionsModal?((0,s.wg)(),(0,s.j4)(d,{key:0,serverURL:a.serverURL,testId:a.testId,token:a.token,onCloseModal:r.closeModal,onAddQuestion:e[5]||(e[5]=t=>r.addQuestion(t))},null,8,["serverURL","testId","token","onCloseModal"])):(0,s.kq)("",!0)])}n(7658);var q=n(4161);const U={class:"questions-modal"},y=(0,s._)("div",null,"Выбор узла",-1),N={class:"questions-table"},k=(0,s._)("th",null,"id",-1),Q=(0,s._)("th",null,"текст",-1),L=(0,s._)("th",null,"вопрос",-1),O=["onClick"],C={class:"table-cell"},$={class:"table-cell"},S={class:"table-cell"};function M(t,e,n,i,a,r){return(0,s.wg)(),(0,s.iD)("div",{onClick:e[0]||(e[0]=(0,o.iM)(((...t)=>r.closeModal&&r.closeModal(...t)),["self"])),class:"modal-wrapper"},[(0,s._)("div",U,[y,(0,s._)("table",N,[k,Q,L,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.questionsList,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id,onClick:e=>r.selectQuestion(t.id),class:"table-row"},[(0,s._)("td",C,(0,c.zw)(t.id),1),(0,s._)("td",$,(0,c.zw)(t.body.infoText),1),(0,s._)("td",S,(0,c.zw)(t.body.questionText),1)],8,O)))),128))])])])}var z={data(){return{questionsList:[]}},props:{serverURL:String,testId:Number,token:String},methods:{GET_QUESTIONS_DATA(){(0,q.Z)({method:"get",url:`${this.serverURL}/admin/test/${this.testId}/questions`,headers:{Authorization:`Bearer ${this.token}`}}).then((t=>{this.questionsList=t.data.data,console.log(t)})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},closeModal(){this.$emit("closeModal")},selectQuestion(t){this.$emit("addQuestion",t),this.closeModal()}},mounted(){this.GET_QUESTIONS_DATA()}};const R=(0,a.Z)(z,[["render",M]]);var Z=R,G={data(){return{serverURL:"https://dev1.med-game.ru/api/v1",testId:11,questionId:563,parentList:[],parentInfoText:"",parentQuestionText:"",infoText:"",questionText:"",answerTransitions:[],showQuestionsModal:!1,token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2ODIxODgyNTkuMDEwMzgzOCwiaWF0IjoxNjgxMTA4MjU5LjAxMDM4OCwidXNlcm5hbWUiOiJhZG1pbiIsInJvbGVzIjpbImFkbWluLXBhcnQiLCJtYW5hZ2UtdXNlcnMiLCJtYW5hZ2Utcm9sZXMiXX0.rdleKvts4biM183bLMHqfm7G6fWhFQxlyLQphINF4hU"}},components:{QuestionstModal:Z},computed:{},methods:{GET_QUESTION_DATA(){(0,q.Z)({method:"get",url:`${this.serverURL}/admin/question/${this.questionId}`,headers:{Authorization:`Bearer ${this.token}`}}).then((t=>{this.setData(t.data.data)})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},UPDATE_QUESTION_DATA(){(0,q.Z)({url:`${this.serverURL}/admin/question/${this.questionId}`,method:"put",headers:{Authorization:`Bearer ${this.token}`},data:{id:this.questionId,question_type_id:2,is_active:!0,test_id:this.testId,seq_no:1,body:{parentList:this.parentList,infoText:this.infoText,questionText:this.questionText,answerTransitions:this.answerTransitions}}}).catch((function(t){console.log(t)}))},DELETE_QUESTION(t){(0,q.Z)({url:`${this.serverURL}/admin/question/${t}`,method:"delete",headers:{Authorization:`Bearer ${this.token}`}}).then((()=>{const e=this.answerTransitions.findIndex((e=>e.transitionId===t));e>=0&&this.answerTransitions.splice(e,1),this.UPDATE_QUESTION_DATA()})).catch((function(t){console.log(t)}))},CHECK_AND_DELETE(t){(0,q.Z)({method:"get",url:`${this.serverURL}/admin/question/${t}`,headers:{Authorization:`Bearer ${this.token}`}}).then((e=>(console.log(e.data.data.body.answerTransitions.length),e.data.data.body.answerTransitions.length?(console.log("У удаляемого объекта есть зависимые узлы: ",e.data.data.body.answerTransitions.length),void console.log("Нельзя удалять объект")):e.data.data.body.parentList.length>1?(console.log("У удаляемого объекта больше одного родителя: ",e.data.data.body.parentList),void console.log("Нельзя удалять объект")):(console.log("Удаляем объект"),void this.DELETE_QUESTION(t))))).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},ADD_QUESTION(){(0,q.Z)({url:`${this.serverURL}/admin/questions`,method:"post",headers:{Authorization:`Bearer ${this.token}`},data:{question_type_id:2,is_active:!0,test_id:this.testId,seq_no:1,body:{parentList:[{id:this.questionId}],infoText:"",questionText:"",answerTransitions:[]}}}).then((t=>{this.answerTransitions.push({transitionId:t.data.data.id,answerText:""}),this.UPDATE_QUESTION_DATA()})).catch((function(t){console.log(t)}))},CHANGE_QUESTION(t,e){(0,q.Z)({url:`${this.serverURL}/admin/question/${t}`,method:"put",headers:{Authorization:`Bearer ${this.token}`},data:{id:this.questionId,question_type_id:2,is_active:!0,test_id:this.testId,seq_no:1,body:{...e}}}).catch((function(t){console.log(t)}))},GET_AND_ADD_PARENT(t){(0,q.Z)({method:"get",url:`${this.serverURL}/admin/question/${t}`,headers:{Authorization:`Bearer ${this.token}`}}).then((e=>{const n=e.data.data.body;n.parentList.push({id:this.questionId}),this.CHANGE_QUESTION(t,n)})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},DELETE_BRANCH(t){(0,q.Z)({method:"get",url:`${this.serverURL}/admin/question/${t}`,headers:{Authorization:`Bearer ${this.token}`}}).then((e=>{const n=e.data.data.body;if(n.parentList.length<2)return!1;const o=n.parentList.findIndex((t=>t.id===this.questionId));return o>=0?(n.parentList.splice(o,1),this.CHANGE_QUESTION(t,n),!0):void 0})).then((e=>{if(e){const e=this.answerTransitions.findIndex((e=>e.transitionId===t));e>=0&&(this.answerTransitions.splice(e,1),this.UPDATE_QUESTION_DATA())}else console.log("Нельзя удалить ветку, так как у дочернего элемента только один родитель")})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},setData(t){this.parentList=t.body.parentList,this.infoText=t.body.infoText,this.questionText=t.body.questionText,this.answerTransitions=t.body.answerTransitions},saveData(){this.UPDATE_QUESTION_DATA()},moveToId(t){this.questionId=t,this.GET_QUESTION_DATA()},moveToParentId(t){this.questionId=t,this.GET_QUESTION_DATA()},selectQuestion(){this.showQuestionsModal=!0},closeModal(){this.showQuestionsModal=!1},addQuestion(t){this.answerTransitions.push({transitionId:t,answerText:""}),this.GET_AND_ADD_PARENT(t),this.UPDATE_QUESTION_DATA()}},mounted(){this.GET_QUESTION_DATA()}};const j=(0,a.Z)(G,[["render",D]]);var P=j;const B=[{path:"/",name:"QuestionPage2",component:P},{path:"/test:testId/question:questionId",name:"question",component:P}],J=(0,u.p7)({history:(0,u.r5)(),routes:B});var F=J,H=n(65),X=(0,H.MT)({state:{serverURL:"https://dev1.med-game.ru/api/v1",testId:11,questionId:563,parentId:0,parentInfoText:"",parentQuestionText:"",infoText:"",questionText:"",answerTransitions:[],currentMoveId:0,isActiveQuestion:!0,token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2ODExMDY1NDEuNDcwNzgzLCJpYXQiOjE2ODAwMjY1NDEuNDcwNzg3LCJ1c2VybmFtZSI6ImFkbWluIiwicm9sZXMiOlsiYWRtaW4tcGFydCIsIm1hbmFnZS11c2VycyIsIm1hbmFnZS1yb2xlcyJdfQ.qngZS7Xu8nEkB1gZCa_UZIbqyONUCFF09S6IF3wzxlo"},getters:{questionId(t){return t.questionId},parentId(t){return t.parentId},infoText(t){return t.infoText},questionText(t){return t.questionText},answerTransitions(t){return t.answerTransitions}},mutations:{setDataQuestion(t,e){t.parentId=e.body.parentId,t.infoText=e.body.infoText,t.questionText=e.body.questionText,t.answerTransitions=e.body.answerTransitions},setParentTexts(t,e){t.parentInfoText=e.body.infoText,t.parentQuestionText=e.body.questionText}},actions:{GET_QUESTION_DATA({state:t,commit:e,dispatch:n}){(0,q.Z)({method:"get",url:`${t.serverURL}/admin/question/${t.questionId}`,headers:{Authorization:`Bearer ${t.token}`}}).then((t=>{e("setDataQuestion",t.data.data),console.log(t)})).then((()=>!t.parentId||n("GET_PARENT_TEXTS"))).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},GET_PARENT_TEXTS({state:t,commit:e}){(0,q.Z)({method:"get",url:`${t.serverURL}/admin/question/${t.parentId}`,headers:{Authorization:`Bearer ${t.token}`}}).then((t=>{e("setParentTexts",t.data.data),console.log("33333333333"),console.log(t)})).catch((t=>(console.log("Ошибка:"),console.log(t),t)))},moveToId({state:t,dispatch:e},n){return t.questionId=n,e("GET_QUESTION_DATA")}},modules:{}}),V=n(9529);n(4415);(0,o.ri)(l).use(X).use(F).use(V.Z).mount("#app")}},e={};function n(o){var s=e[o];if(void 0!==s)return s.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,n),i.exports}n.m=t,function(){var t=[];n.O=function(e,o,s,i){if(!o){var a=1/0;for(u=0;u<t.length;u++){o=t[u][0],s=t[u][1],i=t[u][2];for(var r=!0,d=0;d<o.length;d++)(!1&i||a>=i)&&Object.keys(n.O).every((function(t){return n.O[t](o[d])}))?o.splice(d--,1):(r=!1,i<a&&(a=i));if(r){t.splice(u--,1);var l=s();void 0!==l&&(e=l)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[o,s,i]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var s,i,a=o[0],r=o[1],d=o[2],l=0;if(a.some((function(e){return 0!==t[e]}))){for(s in r)n.o(r,s)&&(n.m[s]=r[s]);if(d)var u=d(n)}for(e&&e(o);l<a.length;l++)i=a[l],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(u)},o=self["webpackChunkmedtest12"]=self["webpackChunkmedtest12"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(2715)}));o=n.O(o)})();
//# sourceMappingURL=app.7360d014.js.map